# 柔軟な予約受付システム

QRコードからスマートフォンでアクセスできる汎用イベント予約システムです。
セミナー、食事会、交流会など様々なイベントに対応できます。

## 🌐 アクセス先

**予約サイト（顧客用）**: https://3000-ib4qz42ytxbtjlo6mabq7-6532622b.e2b.dev

**管理者画面**: https://3000-ib4qz42ytxbtjlo6mabq7-6532622b.e2b.dev/admin

## 📱 主な機能

### 顧客向け機能
- ✅ **イベント一覧表示**: ビジネス・個人イベント一覧を表示
- ✅ **残り席数確認**: リアルタイムで空席状況を確認
- ✅ **柔軟な予約フォーム**: 個人・法人両対応の予約フォーム
- ✅ **参加方法選択**: イベントごとの選択肢（料理、コース等）
- ✅ **予約確認**: 予約コード発行と内容確認
- ✅ **キャンセル機能**: 予約コードでキャンセル可能
- ✅ **スマホ最適化**: レスポンシブデザイン対応

### 管理者向け機能
- ✅ **イベント管理**: 新規イベントの追加・編集・削除
- ✅ **イベントタイプ**: ビジネス（セミナー）・個人（食事会等）の切り替え
- ✅ **予約者管理**: 予約者一覧と詳細確認
- ✅ **QRコード生成**: イベント別QRコード生成・印刷
- ✅ **統計情報**: 稼働率や予約状況、参加方法別統計

## 📋 予約時に入力する項目

### ビジネスイベント（セミナー等）の場合
**法人予約**:
- 会社名
- 役職  
- 参加者氏名
- 連絡先（電話またはメール）

**個人予約**:
- 参加者氏名
- 連絡先（電話またはメール）

### 個人イベント（肉の会等）の場合
- 参加者氏名
- 連絡先（電話またはメール）
- 参加方法選択（料理の種類等）

## 🎯 主な仕様

- **定員**: イベントごとに5名まで（変更可能）
- **予約コード**: 自動生成される8桁の英数字
- **キャンセル**: 予約コードで簡単キャンセル
- **QRコード**: イベントごとに専用QRコード生成
- **イベントタイプ**: ビジネス（セミナー・研修）と個人（食事会・交流会）
- **柔軟な予約フォーム**: イベントタイプに応じて項目が変わる

## 🚀 使用方法

### 1. 顧客の予約手順
1. QRコードをスマートフォンで読み取り
2. イベント一覧から希望のイベントを選択
3. 予約タイプ（個人・法人）を選択（ビジネスイベントの場合）
4. 参加方法を選択（選択肢がある場合）
5. 予約フォームに必要事項を入力
6. 予約確定後、予約コードを保存

### 2. 管理者の使用手順
1. `/admin` にアクセス
2. 新しいイベントを追加
   - イベントタイプを選択（ビジネス・個人）
   - 参加方法選択肢を設定（個人イベントの場合）
3. QRコードを生成・配布
4. 予約者の管理・確認・削除

## 🛠️ 技術仕様

- **Backend**: Node.js + Express
- **Database**: SQLite（軽量でポータブル）
- **Frontend**: EJS + CSS + JavaScript
- **Process Manager**: PM2
- **Libraries**: 
  - qrcode（QRコード生成）
  - moment（日付処理）
  - sqlite3（データベース）

## 📁 ファイル構成

```
/home/user/webapp/
├── server.js              # メインサーバーファイル
├── database/
│   ├── init.js           # データベース初期化
│   └── seminar_booking.db # SQLiteデータベース
├── views/                # EJSテンプレート
├── public/               # 静的ファイル
│   ├── css/style.css    # スタイルシート
│   └── js/app.js        # JavaScript
├── package.json         # 依存関係
└── ecosystem.config.js  # PM2設定
```

## 🗄️ データベース構造

### seminars テーブル
- id: セミナーID（主キー）
- title: セミナータイトル
- description: セミナー説明
- date: 開催日
- time: 開催時刻
- capacity: 定員（デフォルト5名）

### reservations テーブル
- id: 予約ID（主キー）
- seminar_id: セミナーID（外部キー）
- company_name: 会社名
- position: 役職
- participant_name: 参加者氏名
- phone_number: 電話番号
- reservation_code: 予約コード（8桁）
- status: ステータス（active/cancelled）

## 🔧 運用・保守

### サーバー管理コマンド
```bash
# サーバー状態確認
npx pm2 status seminar-booking-system

# サーバー再起動
npx pm2 restart seminar-booking-system

# ログ確認
npx pm2 logs seminar-booking-system --nostream

# サーバー停止
npx pm2 stop seminar-booking-system
```

### データベースバックアップ
SQLiteファイル（`database/seminar_booking.db`）を定期的にバックアップしてください。

## 🔒 セキュリティ要素

- 入力値のバリデーション
- SQLインジェクション対策（prepared statements使用）
- 予約コードによる認証システム
- XSS対策（EJSエスケープ処理）

## 📱 QRコード活用

1. 管理画面でセミナー別QRコードを生成
2. QRコードを印刷して会場やチラシに掲載
3. 参加希望者がスマートフォンで読み取り
4. 直接予約フォームへアクセス

## 🎨 デザイン特徴

- **モバイルファースト**: スマートフォンに最適化
- **直感的UI**: 分かりやすいアイコンと色使い
- **アクセシビリティ**: 見やすいフォントと十分なコントラスト
- **レスポンシブ**: PC・タブレット・スマホ全対応

## 📈 今後の拡張可能性

- メール通知機能
- 複数管理者アカウント
- セミナー会場管理
- 参加者への事前資料配布
- アンケート機能
- 支払い機能
- API提供

---

## 💡 使用開始方法

1. **顧客用サイト**: https://3000-ib4qz42ytxbtjlo6mabq7-6532622b.e2b.dev
2. **管理者画面**: https://3000-ib4qz42ytxbtjlo6mabq7-6532622b.e2b.dev/admin

### サンプルイベント
現在、以下のサンプルイベントが登録されています：
- **DXセミナー 基礎編**（ビジネス）
- **AI活用セミナー**（ビジネス）  
- **肉の会**（個人、参加方法選択あり）

管理画面からイベントを追加し、QRコードを生成してご利用ください。